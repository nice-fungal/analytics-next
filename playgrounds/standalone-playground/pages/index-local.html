<html>

<head>
  <style>
    body {
      font-family: monospace;
    }

    #event {
      margin: 2em 0;
      min-height: 200px;
      min-width: 700px;
    }
  </style>

  <script>
    var ANALYTICS_WRITE_KEY = 'GW4vMpvTuG8m29dHAj1K1udTScVuDoAa';
    var ANALYTICS_LEGACY_SETTINGS = {
      analyticsNextEnabled: true,
      integrations: {
        // "Actions Google Analytic 4": {
        //   versionSettings: { componentTypes: ['browser'], version: '' } },
        // "Segment.io": { "apiKey": "GW4vMpvTuG8m29dHAj1K1udTScVuDoAa", "unbundledIntegrations": [], "addBundledMetadata": true, "maybeBundledConfigIds": {},
        //   versionSettings: { componentTypes: ['browser'], version: '4.4.7' } }
      },
      remotePlugins: [
        {
          name: 'Console',
          settings: { id: 'ak', endpoint: 'endpoint', writeKey: 'writeKeyValue', sampleRate: 100 },
          // @head/o11y
          url: 'http://127.0.0.1:8000/analytics-plugin-console.js',
        },
        // {
        //   name: 'Guancecom',
        //   settings: { id: 'ak', endpoint: 'https://api.bo7.co',
        //     // allowedTracingOrigins: ['https://api.bo7.co'],
        //   },
        //   // @head/o11y
        //   // url: 'http://127.0.0.1:8000/analytics-plugin-guancecom.js',
        // },
        // {
        //   name: 'Datadogcom',
        //   settings: { id: 'b2646746-e670-41ce-9450-74ac9d969301', token: 'pube17b7c0087821dcb33e06f3d94eb67f4', endpoint: 'datadoghq.eu',
        //     sampleRate: 100,
        //     sessionReplaySampleRate: 20,
        //     trackInteractions: true,
        //     trackResources: true,
        //     trackLongTasks: true,
        //     defaultPrivacyLevel:'mask-user-input',
        //     allowedTracingOrigins: ['https://api.bo7.co'],
        //   },
        // },
        // {
        //   name: 'Segmentio',
        //   settings: { endpoint: 'https://api.segment.io/v1', token: ANALYTICS_WRITE_KEY },
        //   // @head/o11y
        //   // url: 'http://127.0.0.1:8000/analytics-plugin-segmentio.js',
        // },
      ],
      metrics: { sampleRate: 1 },
      plan: {
        track: { __default: { enabled: true, integrations: {} } },
        identify: { __default: { enabled: true } },
        group: { __default: { enabled: true } }
      },
      edgeFunction: {},
      middlewareSettings: {},
      enabledMiddleware: {},
      legacyVideoPluginsEnabled: true,
    };
  </script>

  <script>
    console.profile('snippet')
    console.time('snippet')
    !(function () {
      var analytics = (window.analytics = window.analytics || [])
      if (!analytics.initialize)
        if (analytics.invoked)
          window.console &&
            console.error &&
            console.error('Segment snippet included twice.')
        else {
          analytics.invoked = !0
          analytics.methods = [
            'screen',
            'register',
            'deregister',
            'trackSubmit',
            'trackClick',
            'trackLink',
            'trackForm',
            'pageview',
            'identify',
            'reset',
            'group',
            'track',
            'ready',
            'alias',
            'debug',
            'page',
            'once',
            'off',
            'on',
            'addSourceMiddleware',
            'addIntegrationMiddleware',
            'setAnonymousId',
            'addDestinationMiddleware',
          ]
          analytics.factory = function (e) {
            return function () {
              var t = Array.prototype.slice.call(arguments)
              t.unshift(e)
              analytics.push(t)
              return analytics
            }
          }
          for (var e = 0; e < analytics.methods.length; e++) {
            var key = analytics.methods[e]
            analytics[key] = analytics.factory(key)
          }
          analytics.load = function (settings, options) {
            var t = document.createElement('script')
            t.type = 'text/javascript'
            t.async = !0
            t.src = '/node_modules/@segment/analytics-next/dist/umd/standalone.js'
            var n = document.getElementsByTagName('script')[0]
            n.parentNode.insertBefore(t, n)
          }
          analytics.SNIPPET_VERSION = '4.13.1'

          var ANALYTICS_LOAD_SETTINGS = {
            cdnSettings: ANALYTICS_LEGACY_SETTINGS,
            writeKey: ANALYTICS_WRITE_KEY,
            cdnURL: 'https://gitlab-hbrls.lisitede.com/web-starter/',
            app: {
              service: 'ak.bo7.co',
              profile: 'local',
              version: 1,
            },
            rum: {
              denyResourceOrigins: [ 'datadoghq.eu', 'datakit-api.lisitede.com' ],
            },
          };

          var ANALYTICS_LOAD_OPTIONS = {}

          analytics._writeKey = ANALYTICS_WRITE_KEY
          analytics._loadSettings = ANALYTICS_LOAD_SETTINGS
          analytics._loadOptions = ANALYTICS_LOAD_OPTIONS

          analytics.load(ANALYTICS_LOAD_SETTINGS, ANALYTICS_LOAD_OPTIONS)
          analytics.page()
        }
    })()
  </script>
</head>

<body>
  <form>
    <textarea name="event" id="event">
{
  "name": "hi",
  "properties": { },
  "options": { },
  "callback": null
}
    </textarea>
    <div>
      <button id="track">Track</button>
      <button id="identify">Identify</button>
    </div>
  </form>

  <pre id="ready-logs"></pre>
  <pre id="logs"></pre>

  <script type="text/javascript">
    if (window.analytics) {
      window.analytics.ready(function onReady() {
        console.profileEnd('snippet')
        console.timeEnd('snippet')
        document.querySelector('#ready-logs').textContent = 'ready!'
      })

      document.querySelector('#track').addEventListener('click', function (e) {
        e.preventDefault()
        var contents = document.querySelector('#event').value
        var evt = JSON.parse(contents)
        console.profile('track')
        console.time('track')
        var promise = window.analytics.track(
          evt.name || '',
          evt.properties || {},
          evt.options || {}
        )

        promise &&
          promise.then &&
          promise.then(function (ctx) {
            console.timeEnd('track')
            console.profileEnd('track')
            ctx.flush()
            document.querySelector('#logs').textContent = JSON.stringify(
              ctx.event,
              null,
              '  '
            )
          })
      })

      document
        .querySelector('#identify')
        .addEventListener('click', function (e) {
          e.preventDefault()
          var contents = document.querySelector('#event').value
          var evt = JSON.parse(contents)
          console.time('identify')
          var promise = window.analytics.identify(
            evt.name || '',
            evt.properties || {},
            evt.options || {}
          )

          promise &&
            promise.then &&
            promise.then(function (ctx) {
              console.timeEnd('identify')
              ctx.flush()
              document.querySelector('#logs').textContent = JSON.stringify(
                ctx.event,
                null,
                '  '
              )
            })
        })
    }
  </script>
</body>

</html>
